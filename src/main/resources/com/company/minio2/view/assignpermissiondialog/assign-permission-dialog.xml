<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://assignPermissionDialog.title">
    <data>
        <collection id="permissionsDc" class="com.company.minio2.entity.Permission">
            <fetchPlan extends="_base">
                <property name="permissionType"/>
                <property name="user" fetchPlan="_base"/>
            </fetchPlan>
            <loader id="permissionsDl">
                <query>
                    <![CDATA[select p from Permission p
                where p.filePath = :filePath and p.user = :user]]>
                </query>
            </loader>
        </collection>
        <collection id="usersDc"
                    class="com.company.minio2.entity.User">
            <fetchPlan extends="_base">
                <property name="username"/>
            </fetchPlan>
            <loader id="usersDl" readOnly="true">
                <query><![CDATA[select e from User e order by e.username]]></query>
            </loader>
        </collection>
        <collection id="rolesDc"
                    class="io.jmix.securitydata.entity.ResourceRoleEntity">
            <fetchPlan extends="_base">
                <property name="name"/>
                <property name="code"/>
            </fetchPlan>
            <loader id="rolesDl" readOnly="true">
                <query><![CDATA[select r from sec_ResourceRoleEntity r order by r.name]]></query>
            </loader>
        </collection>
    </data>
    <layout height="500px" width="500px">
        <textArea id="fileKeyArea" label="Object key: " readOnly="true" width="100%"/>
        <vbox spacing="true" width="100%" height="400px" >
            <dataGrid id="usersDataGrid" dataContainer="usersDc" width="100%" height="200px">
                <columns>
                    <column property="username" header="User" />
                </columns>
            </dataGrid>
        </vbox>
        <vbox spacing="true" width="100%" height="200px">
            <dataGrid id="rolesDataGrid" dataContainer="rolesDc" width="100%" height="200px">
                <columns>
                    <column property="name" header="Role Name"/>
                </columns>
            </dataGrid>
        </vbox>
        <hbox spacing="true">
            <button id="editBtn" text="Edit"/>
        </hbox>
        <vbox width="100%" height="100%">
            <dataGrid id="permissionDataGrid" dataContainer="permissionsDc">
                <columns>
                    <column property="permissionType" header="Permission" width="50%"/>
                </columns>
            </dataGrid>
        </vbox>
    </layout>
</view>